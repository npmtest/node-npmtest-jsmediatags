<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-jsmediatags/node_modules/jsmediatags/build2/ChunkedFileData.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-jsmediatags">npmtest-jsmediatags (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-jsmediatags/node_modules/jsmediatags/build2/ChunkedFileData.js</span></h1>
    <h2>
        
        Statements: <span class="metric">2.9% <small>(2 / 69)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 40)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 8)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">2.9% <small>(2 / 69)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-jsmediatags/node_modules/jsmediatags/build2/</a> &#187; ChunkedFileData.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * This class represents a file that might not have all its data loaded yet.
 * It is used when loading the entire file is not an option because it's too
 * expensive. Instead, parts of the file are loaded and added only when needed.
 * From a reading point of view is as if the entire file is loaded. The
 * exception is when the data is not available yet, an error will be thrown.
 * This class does not load the data, it just manages it. It provides operations
 * to add and read data from the file.
 *
 * 
 */
'use strict';
&nbsp;
const NOT_FOUND = -1;
&nbsp;
class ChunkedFileData {
  // $FlowIssue - get/set properties not yet supported
  static get NOT_FOUND<span class="fstat-no" title="function not covered" >() {</span>
<span class="cstat-no" title="statement not covered" >    return NOT_FOUND;</span>
  }
&nbsp;
&nbsp;
  constructor<span class="fstat-no" title="function not covered" >() {</span>
<span class="cstat-no" title="statement not covered" >    this._fileData = [];</span>
  }
&nbsp;
  /**
   * Adds data to the file storage at a specific offset.
   */
  addData<span class="fstat-no" title="function not covered" >(offset, data) {</span>
<span class="cstat-no" title="statement not covered" >    var offsetEnd = offset + data.length - 1;</span>
<span class="cstat-no" title="statement not covered" >    var chunkRange = this._getChunkRange(offset, offsetEnd);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (chunkRange.startIx === NOT_FOUND) {</span>
<span class="cstat-no" title="statement not covered" >      this._fileData.splice(chunkRange.insertIx || 0, 0, {</span>
        offset: offset,
        data: data
      });
    } else {
      // If the data to add collides with existing chunks we prepend and
      // append data from the half colliding chunks to make the collision at
      // 100%. The new data can then replace all the colliding chunkes.
<span class="cstat-no" title="statement not covered" >      var firstChunk = this._fileData[chunkRange.startIx];</span>
<span class="cstat-no" title="statement not covered" >      var lastChunk = this._fileData[chunkRange.endIx];</span>
<span class="cstat-no" title="statement not covered" >      var needsPrepend = offset &gt; firstChunk.offset;</span>
<span class="cstat-no" title="statement not covered" >      var needsAppend = offsetEnd &lt; lastChunk.offset + lastChunk.data.length - 1;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      var chunk = {</span>
        offset: Math.min(offset, firstChunk.offset),
        data: data
      };
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (needsPrepend) {</span>
<span class="cstat-no" title="statement not covered" >        var slicedData = this._sliceData(firstChunk.data, 0, offset - firstChunk.offset);</span>
<span class="cstat-no" title="statement not covered" >        chunk.data = this._concatData(slicedData, data);</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (needsAppend) {</span>
        // Use the lastChunk because the slice logic is easier to handle.
<span class="cstat-no" title="statement not covered" >        var slicedData = this._sliceData(chunk.data, 0, lastChunk.offset - chunk.offset);</span>
<span class="cstat-no" title="statement not covered" >        chunk.data = this._concatData(slicedData, lastChunk.data);</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      this._fileData.splice(chunkRange.startIx, chunkRange.endIx - chunkRange.startIx + 1, chunk);</span>
    }
  }
&nbsp;
  _concatData<span class="fstat-no" title="function not covered" >(dataA, dataB) {</span>
    // TypedArrays don't support concat.
<span class="cstat-no" title="statement not covered" >    if (typeof ArrayBuffer !== "undefined" &amp;&amp; ArrayBuffer.isView(dataA)) {</span>
      // $FlowIssue - flow thinks dataAandB is a string but it's not
<span class="cstat-no" title="statement not covered" >      var dataAandB = new dataA.constructor(dataA.length + dataB.length);</span>
      // $FlowIssue - flow thinks dataAandB is a string but it's not
<span class="cstat-no" title="statement not covered" >      dataAandB.set(dataA, 0);</span>
      // $FlowIssue - flow thinks dataAandB is a string but it's not
<span class="cstat-no" title="statement not covered" >      dataAandB.set(dataB, dataA.length);</span>
<span class="cstat-no" title="statement not covered" >      return dataAandB;</span>
    } else {
      // $FlowIssue - flow thinks dataAandB is a TypedArray but it's not
<span class="cstat-no" title="statement not covered" >      return dataA.concat(dataB);</span>
    }
  }
&nbsp;
  _sliceData<span class="fstat-no" title="function not covered" >(data, begin, end) {</span>
    // Some TypeArray implementations do not support slice yet.
<span class="cstat-no" title="statement not covered" >    if (data.slice) {</span>
<span class="cstat-no" title="statement not covered" >      return data.slice(begin, end);</span>
    } else {
      // $FlowIssue - flow thinks data is a string but it's not
<span class="cstat-no" title="statement not covered" >      return data.subarray(begin, end);</span>
    }
  }
&nbsp;
  /**
   * Finds the chunk range that overlaps the [offsetStart-1,offsetEnd+1] range.
   * When a chunk is adjacent to the offset we still consider it part of the
   * range (this is the situation of offsetStart-1 or offsetEnd+1).
   * When no chunks are found `insertIx` denotes the index where the data
   * should be inserted in the data list (startIx == NOT_FOUND and endIX ==
   * NOT_FOUND).
   */
  _getChunkRange<span class="fstat-no" title="function not covered" >(offsetStart, offsetEnd) {</span>
<span class="cstat-no" title="statement not covered" >    var startChunkIx = NOT_FOUND;</span>
<span class="cstat-no" title="statement not covered" >    var endChunkIx = NOT_FOUND;</span>
<span class="cstat-no" title="statement not covered" >    var insertIx = 0;</span>
&nbsp;
    // Could use binary search but not expecting that many blocks to exist.
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; this._fileData.length; i++, insertIx = i) {</span>
<span class="cstat-no" title="statement not covered" >      var chunkOffsetStart = this._fileData[i].offset;</span>
<span class="cstat-no" title="statement not covered" >      var chunkOffsetEnd = chunkOffsetStart + this._fileData[i].data.length;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (offsetEnd &lt; chunkOffsetStart - 1) {</span>
        // This offset range doesn't overlap with any chunks.
<span class="cstat-no" title="statement not covered" >        break;</span>
      }
      // If it is adjacent we still consider it part of the range because
      // we're going end up with a single block with all contiguous data.
<span class="cstat-no" title="statement not covered" >      if (offsetStart &lt;= chunkOffsetEnd + 1 &amp;&amp; offsetEnd &gt;= chunkOffsetStart - 1) {</span>
<span class="cstat-no" title="statement not covered" >        startChunkIx = i;</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      }
    }
&nbsp;
    // No starting chunk was found, meaning that the offset is either before
    // or after the current stored chunks.
<span class="cstat-no" title="statement not covered" >    if (startChunkIx === NOT_FOUND) {</span>
<span class="cstat-no" title="statement not covered" >      return {</span>
        startIx: NOT_FOUND,
        endIx: NOT_FOUND,
        insertIx: insertIx
      };
    }
&nbsp;
    // Find the ending chunk.
<span class="cstat-no" title="statement not covered" >    for (var i = startChunkIx; i &lt; this._fileData.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      var chunkOffsetStart = this._fileData[i].offset;</span>
<span class="cstat-no" title="statement not covered" >      var chunkOffsetEnd = chunkOffsetStart + this._fileData[i].data.length;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (offsetEnd &gt;= chunkOffsetStart - 1) {</span>
        // Candidate for the end chunk, it doesn't mean it is yet.
<span class="cstat-no" title="statement not covered" >        endChunkIx = i;</span>
      }
<span class="cstat-no" title="statement not covered" >      if (offsetEnd &lt;= chunkOffsetEnd + 1) {</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (endChunkIx === NOT_FOUND) {</span>
<span class="cstat-no" title="statement not covered" >      endChunkIx = startChunkIx;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return {</span>
      startIx: startChunkIx,
      endIx: endChunkIx
    };
  }
&nbsp;
  hasDataRange<span class="fstat-no" title="function not covered" >(offsetStart, offsetEnd) {</span>
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; this._fileData.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      var chunk = this._fileData[i];</span>
<span class="cstat-no" title="statement not covered" >      if (offsetEnd &lt; chunk.offset) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (offsetStart &gt;= chunk.offset &amp;&amp; offsetEnd &lt; chunk.offset + chunk.data.length) {</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return false;</span>
  }
&nbsp;
  getByteAt<span class="fstat-no" title="function not covered" >(offset) {</span>
<span class="cstat-no" title="statement not covered" >    var dataChunk;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; this._fileData.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      var dataChunkStart = this._fileData[i].offset;</span>
<span class="cstat-no" title="statement not covered" >      var dataChunkEnd = dataChunkStart + this._fileData[i].data.length - 1;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (offset &gt;= dataChunkStart &amp;&amp; offset &lt;= dataChunkEnd) {</span>
<span class="cstat-no" title="statement not covered" >        dataChunk = this._fileData[i];</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (dataChunk) {</span>
<span class="cstat-no" title="statement not covered" >      return dataChunk.data[offset - dataChunk.offset];</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    throw new Error("Offset " + offset + " hasn't been loaded yet.");</span>
  }
}
&nbsp;
module.exports = ChunkedFileData;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Fri Apr 21 2017 14:08:33 GMT+0000 (UTC)</div>
</div>
</body>
</html>
